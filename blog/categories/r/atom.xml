<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: R | Linkage Disequilibrium]]></title>
  <link href="http://www.sahirbhatnagar.com/blog/categories/r/atom.xml" rel="self"/>
  <link href="http://www.sahirbhatnagar.com/"/>
  <updated>2014-11-15T23:39:44-05:00</updated>
  <id>http://www.sahirbhatnagar.com/</id>
  <author>
    <name><![CDATA[Sahir Rai Bhatnagar]]></name>
    <email><![CDATA[sahir.bhatnagar@gmail.com]]></email>
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Gradient Descent]]></title>
    <link href="http://www.sahirbhatnagar.com/blog/2014/11/15/gradientdescent/"/>
    <updated>2014-11-15T23:16:00-05:00</updated>
    <id>http://www.sahirbhatnagar.com/blog/2014/11/15/gradientdescent</id>
    <content type="html"><![CDATA[<p>I am taking the Machine Learning course on <a href="https://class.coursera.org/ml-007/lecture">Coursera</a> being taught by Andrew Ng. It is turning out to be useful so far, and he has presented the material clearly. It’s a nice introduction to the Machine Learning/Computer Science language, since I come from a statistics background.</p>
<p>I learned about gradient descent today for simple linear regression. The following is my code in R and I compare it to the <em>lm</em> function in base <em>R</em>.</p>
<p>I am using the <strong>Prostate</strong> dataset from the <em>lasso2</em> package. The model I am fitting is:</p>
<p><span class="math">\[ lpsa = \beta_0 + \beta_1 \times lcavol \]</span></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#prostate cancer data set</span>
<span class="kw">library</span>(lasso2)</code></pre>
<pre><code>## R Package to solve regression problems while imposing
##   an L1 constraint on the parameters. Based on S-plus Release 2.1
## Copyright (C) 1998, 1999
## Justin Lokhorst   &lt;jlokhors@stats.adelaide.edu.au&gt;
## Berwin A. Turlach &lt;bturlach@stats.adelaide.edu.au&gt;
## Bill Venables     &lt;wvenable@stats.adelaide.edu.au&gt;
## 
## Copyright (C) 2002
## Martin Maechler &lt;maechler@stat.math.ethz.ch&gt;</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(Prostate)

<span class="co"># hypothesis</span>
hypothesis &lt;-<span class="st"> </span>function(x, theta0,theta1){
    h &lt;-<span class="st"> </span>theta0 +<span class="st"> </span>theta1*x
    <span class="kw">return</span>(h)
}

<span class="co"># Jacobian</span>
deriv &lt;-<span class="st"> </span>function(x,y,theta0,theta1){
    dt0 &lt;-<span class="st"> </span>(<span class="kw">length</span>(x))^(-<span class="dv">1</span>)*<span class="st"> </span><span class="kw">sum</span>((<span class="kw">hypothesis</span>(x,theta0,theta1)-y))
    dt1 &lt;-<span class="st"> </span>(<span class="kw">length</span>(x))^(-<span class="dv">1</span>)*<span class="st"> </span><span class="kw">t</span>(x) %*%<span class="st"> </span>(<span class="kw">hypothesis</span>(x,theta0,theta1)-y)
    <span class="kw">return</span>(<span class="kw">c</span>(dt0,dt1))
}

theta &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)
alpha &lt;-<span class="st"> </span><span class="fl">0.5</span>
X &lt;-<span class="st"> </span>Prostate$lcavol
Y &lt;-<span class="st"> </span>Prostate$lpsa
i=<span class="dv">1</span>
<span class="co">#</span>
theta.star &lt;-<span class="st"> </span><span class="kw">deriv</span>(Prostate$lcavol,Prostate$lpsa,theta[<span class="dv">1</span>],theta[<span class="dv">2</span>])
<span class="co"># set convergence threshold</span>
threshold &lt;-<span class="st"> </span><span class="fl">1e-7</span>
<span class="co"># logical to check if threshold has been achieved</span>
continue=<span class="ot">TRUE</span>

while (continue){
    theta[<span class="dv">1</span>] &lt;-<span class="st"> </span>theta.star[<span class="dv">1</span>] -<span class="st"> </span>alpha*<span class="kw">deriv</span>(<span class="dt">x=</span>X,<span class="dt">y=</span>Y,theta.star[<span class="dv">1</span>],theta.star[<span class="dv">2</span>])[<span class="dv">1</span>]
    theta[<span class="dv">2</span>] &lt;-<span class="st"> </span>theta.star[<span class="dv">2</span>] -<span class="st"> </span>alpha*<span class="kw">deriv</span>(<span class="dt">x=</span>X,<span class="dt">y=</span>Y,theta.star[<span class="dv">1</span>],theta.star[<span class="dv">2</span>])[<span class="dv">2</span>]
    continue &lt;-<span class="st"> </span>(<span class="kw">abs</span>((theta.star-theta)[<span class="dv">1</span>])&gt;threshold &amp;<span class="st"> </span><span class="kw">abs</span>((theta.star-theta)[<span class="dv">2</span>])&gt;threshold)
    theta.star[<span class="dv">1</span>] &lt;-<span class="st"> </span>theta[<span class="dv">1</span>]
    theta.star[<span class="dv">2</span>] &lt;-<span class="st"> </span>theta[<span class="dv">2</span>]
    i=i<span class="dv">+1</span>
}

<span class="co"># number of iterations</span>
i</code></pre>
<pre><code>## [1] 214</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># beta0 and beta1</span>
theta.star</code></pre>
<pre><code>## [1] 1.5073 0.7193</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># compare to lm</span>
fit &lt;-<span class="st"> </span><span class="kw">lm</span>(lpsa~lcavol, <span class="dt">data=</span>Prostate)
<span class="kw">summary</span>(fit)</code></pre>
<pre><code>## 
## Call:
## lm(formula = lpsa ~ lcavol, data = Prostate)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1.6762 -0.4165  0.0986  0.5071  1.8967 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   1.5073     0.1219    12.4   &lt;2e-16 ***
## lcavol        0.7193     0.0682    10.6   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.787 on 95 degrees of freedom
## Multiple R-squared:  0.539,  Adjusted R-squared:  0.535 
## F-statistic:  111 on 1 and 95 DF,  p-value: &lt;2e-16</code></pre>]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Test Rmd]]></title>
    <link href="http://www.sahirbhatnagar.com/blog/2014/09/05/test-rmd/"/>
    <updated>2014-09-05T21:45:00-04:00</updated>
    <id>http://www.sahirbhatnagar.com/blog/2014/09/05/test-rmd</id>
    <content type="html"><![CDATA[<h1 id="methods">Methods</h1>
<h2 id="transmission-disequilibrium-test">Transmission Disequilibrium Test</h2>
<table>
<col style="width: 27%" /><col style="width: 29%" /><col style="width: 29%" /><col style="width: 11%" /><thead>
<tr class="header">
<th style="text-align: center;"> </th>
<th style="text-align: center;">A non transmitted</th>
<th style="text-align: center;">B non transmitted</th>
<th style="text-align: left;">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">A transmitted</td>
<td style="text-align: center;">a</td>
<td style="text-align: center;">b</td>
<td style="text-align: left;">a+b</td>
</tr>
<tr class="even">
<td style="text-align: center;">B transmitted</td>
<td style="text-align: center;">c</td>
<td style="text-align: center;">d</td>
<td style="text-align: left;">c+d</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Total</td>
<td style="text-align: center;">a+c</td>
<td style="text-align: center;">b+d</td>
<td style="text-align: left;">2n</td>
</tr>
</tbody>
</table>
<blockquote>
<ul>
<li>[ ^2_{(TDT)} =  ^2_{(1)} ]</li>
</ul>
</blockquote>
<blockquote>
<ul>
<li>This is also known as a McNemar Test</li>
</ul>
</blockquote>
<h2 id="pedigree-disequilibrium-test-pdt-informative-trios">Pedigree Disequilibrium Test (PDT) | Informative Trios</h2>
<p><img src="../figure/2014-09-05-test-rmd-unnamed-chunk-1.png" title="plot of chunk unnamed-chunk-1" alt="plot of chunk unnamed-chunk-1" style="display: block; margin: auto;" /></p>
<h2 id="pedigree-disequilibrium-test-pdt-informative-discordant-sibships">Pedigree Disequilibrium Test (PDT) | Informative Discordant Sibships</h2>
<p><img src="../figure/2014-09-05-test-rmd-unnamed-chunk-2.png" title="plot of chunk unnamed-chunk-2" alt="plot of chunk unnamed-chunk-2" style="display: block; margin: auto;" /></p>
<h2 id="pedigree-disequilibrium-test-pdt">Pedigree Disequilibrium Test (PDT)</h2>
<p>Within an informative nuclear family define:</p>
<ul>
<li><span class="math">\(X_T\)</span> = (#<span class="math">\(A\)</span> transmitted) - (#<span class="math">\(A\)</span> not transmitted) <span class="math">\(\rightarrow\)</span> <span class="math">\(n_T\)</span> <em>trios</em></li>
<li><span class="math">\(X_S\)</span> = (#<span class="math">\(A\)</span> affected sib) - (#<span class="math">\(A\)</span> unaffected sib) <span class="math">\(\rightarrow\)</span> <span class="math">\(n_s\)</span> <em>sibships</em></li>
</ul>
<p>[D= ( X_{T} + X_{S} ) ]</p>
<p>For <span class="math">\(k=1,\ldots,N\)</span> unrelated informative pedigrees</p>
<p>[ PDT_{test} =  (0,1) ]</p>
<h2 id="family-based-association-test-fbat">Family Based Association Test (FBAT)</h2>
<div class="red2">
A unified approach to family based tests of association that can handle:
</div>
<ol type="1">
<li>Different genetic models</li>
<li>Sampling designs</li>
<li>Multiallelic markers</li>
<li>Quantitative traits</li>
<li>Missing parental genotype information</li>
</ol>
<h2 id="family-based-association-test-fbat-1">Family Based Association Test (FBAT)</h2>
<blockquote>
<ul>
<li>The FBAT statistic is based on the <strong>covariance</strong> between genotype and phenotype</li>
</ul>
</blockquote>
<blockquote>
<ul>
<li>What is covariance ?</li>
</ul>
</blockquote>
<blockquote>
<ul>
<li>A measure of how much two random variables change together
<ul>
<li><span class="math">\(R^2\)</span> is normalized version of the covariance</li>
</ul></li>
</ul>
</blockquote>
<h2 id="family-based-association-test-fbat-test-statistic">Family Based Association Test (FBAT) | Test Statistic</h2>
<p>[ U = T^*  ] [ FBAT =  ^2_{(1)}  ]</p>
<ul>
<li><span class="math">\(X\)</span>: translates offspring’s genotype to a numeric value e.g. count of A alleles (random)</li>
<li><span class="math">\(P\)</span>: genotype of offspring’s parents (fixed)</li>
<li><span class="math">\(T\)</span>: offspring’s trait (fixed)</li>
<li>summation is over all offspring in the sample</li>
</ul>
<h2 id="family-based-association-test-fbat-why-so-flexible">Family Based Association Test (FBAT) | Why so flexible ?</h2>
<blockquote>
<ul>
<li>Of interest is the offspring’s genotype
<ul>
<li>Missing parental genotypes are <em>nuisance</em> parameters</li>
</ul></li>
<li>Standard approach to handling <em>nuisance</em> parameters:
<ul>
<li>Find sufficient statistics for them</li>
<li>Condition on the sufficient statistics</li>
<li>Conditional distribution does not depend on <em>nuisance</em> parameters</li>
</ul></li>
</ul>
</blockquote>
<h2 id="comparison-of-methods" class="smaller">Comparison of Methods</h2>
<table>
<thead>
<tr class="header">
<th style="text-align: center;">attribute</th>
<th style="text-align: center;">TDT</th>
<th style="text-align: center;">PDT</th>
<th style="text-align: center;">FBAT</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">affected child</td>
<td style="text-align: center;">✓</td>
<td style="text-align: center;">✓</td>
<td style="text-align: center;">✓</td>
</tr>
<tr class="even">
<td style="text-align: center;">1 heterozygous parent</td>
<td style="text-align: center;">✓</td>
<td style="text-align: center;">✓</td>
<td style="text-align: center;">✓</td>
</tr>
<tr class="odd">
<td style="text-align: center;">biallelic markers</td>
<td style="text-align: center;">✓</td>
<td style="text-align: center;">✓</td>
<td style="text-align: center;">✓</td>
</tr>
<tr class="even">
<td style="text-align: center;">trios</td>
<td style="text-align: center;">✓</td>
<td style="text-align: center;">✓</td>
<td style="text-align: center;">✓</td>
</tr>
<tr class="odd">
<td style="text-align: center;">missing parental genotypes</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">✓</td>
<td style="text-align: center;">✓</td>
</tr>
<tr class="even">
<td style="text-align: center;">discordant sibships</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">✓</td>
<td style="text-align: center;">✓</td>
</tr>
<tr class="odd">
<td style="text-align: center;">pedigrees</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">✓</td>
<td style="text-align: center;">✓</td>
</tr>
<tr class="even">
<td style="text-align: center;">multiallelic markers</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">✓</td>
</tr>
<tr class="odd">
<td style="text-align: center;">quantitative Traits</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">✓</td>
</tr>
</tbody>
</table>]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Testing Rmd]]></title>
    <link href="http://www.sahirbhatnagar.com/blog/2014/09/04/testing-rmd/"/>
    <updated>2014-09-04T14:37:00-04:00</updated>
    <id>http://www.sahirbhatnagar.com/blog/2014/09/04/testing-rmd</id>
    <content type="html"><![CDATA[<pre><code>## Error: Invalid name specified, see ?BibOptions</code></pre>
<p>It has been quiet the last months here - main reason is that I’m working on my master’s thesis. I have already prepared some more examples from ‘Quantitative Ecotoxicolgy’, but I didn’t come to publish them here.</p>
<p>This post is about collinearity and the implications for linear models. The best way to explore this is by simulations - where I create data with known properties and look what happens.</p>
<h3 id="create-correlated-random-variables">Create correlated random variables</h3>
<p>The first problem for this simulation was: How can we create correlated random variables?</p>
<p>This simulation is similar to the one in, where it is also mentioned that one could use Cholesky Decompostion to create correlated variables:</p>
<p>What this function function does:</p>
<ul>
<li>Create two normal random variables (X1, X2 ~ N(0, 1))</li>
<li>Create desired correlation matrix</li>
<li>Compute the Choleski factorization of the correlation matrix ( R )</li>
<li>Apply the resulting matrix on the two variables (this rotates, shears and scales the variables so that they are correlated)</li>
<li>Create a dependent variable <code>y</code> after the model:</li>
</ul>
<p><code>y ~ 5 + 7*X1 + 7*X2 + e</code> with <code>e ~ N(0, 1)</code></p>
<pre class="sourceCode r"><code class="sourceCode r">#############################################################################
<span class="co"># create two correlated variables and a dependent variable</span>
<span class="co"># n : number of points</span>
<span class="co"># p:correlation</span>

datagen &lt;-<span class="st"> </span>function(n , p){
  <span class="co"># random points N(0,1)</span>
  x1 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n)
  x2 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n)
  X &lt;-<span class="st"> </span><span class="kw">cbind</span>(x1, x2)
  
  <span class="co"># desired correlation matrix</span>
  R &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>, p, p, <span class="dv">1</span>), <span class="dt">ncol =</span> <span class="dv">2</span>)
  
  <span class="co"># use cholesky decomposition `t(U) %*% U = R`</span>
  U &lt;-<span class="st"> </span><span class="kw">chol</span>(R)
  corvars &lt;-<span class="st"> </span>X %*%<span class="st"> </span>U
  
  <span class="co"># create dependent variable after model:</span>
  <span class="co"># y ~ 5 + 7 * X1 + 7 * X2 + e | E ~ N(0,10)</span>
  y &lt;-<span class="st"> </span><span class="dv">5</span> +<span class="st"> </span><span class="dv">7</span>*corvars[,<span class="dv">1</span>] +<span class="st"> </span><span class="dv">7</span>*corvars[,<span class="dv">2</span>] +<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)
  df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(y, corvars)
  <span class="kw">return</span>(df)
}</code></pre>
<p>Let’s see if it works. This creates two variables with 1000 observations with a correlation of 0.8 between them and a dependent variable.</p>
<pre class="sourceCode r"><code class="sourceCode r">df1 &lt;-<span class="st"> </span><span class="kw">datagen</span>(<span class="dt">n =</span> <span class="dv">1000</span>, <span class="dt">p =</span> <span class="fl">0.8</span>)</code></pre>
<p>The correlation between X1 and X2 is as desired nearly 0.8</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cor</span>(df1)</code></pre>
<pre><code>##          y      X1      X2
## y  1.00000 0.94390 0.94367
## X1 0.94390 1.00000 0.79192
## X2 0.94367 0.79192 1.00000</code></pre>
<p>And the data follows the specified model.</p>
<pre class="sourceCode r"><code class="sourceCode r">mod &lt;-<span class="st"> </span><span class="kw">lm</span>(y~X1+X2, <span class="dt">data =</span> df1)
<span class="kw">summary</span>(mod)</code></pre>
<pre><code>## 
## Call:
## lm(formula = y ~ X1 + X2, data = df1)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -2.908 -0.685  0.008  0.692  3.180 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   5.0440     0.0316     160   &lt;2e-16 ***
## X1            7.0517     0.0530     133   &lt;2e-16 ***
## X2            6.9496     0.0524     133   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.997 on 997 degrees of freedom
## Multiple R-squared:  0.994,  Adjusted R-squared:  0.994 
## F-statistic: 8.48e+04 on 2 and 997 DF,  p-value: &lt;2e-16</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pairs</span>(df1)</code></pre>
<figure>
<img src="../figure/2014-09-04-testing-rmd-example_datagen3.png" alt="plot of chunk example_datagen3" /><figcaption>plot of chunk example_datagen3</figcaption>
</figure>]]></content>
  </entry>
  
</feed>
