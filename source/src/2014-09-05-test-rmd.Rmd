---
layout: post
title: "test rmd"
date: 2014-09-05 21:45
comments: true
categories: [R,RMarkdown]
published: true
---

# Methods

## Transmission Disequilibrium Test 

---------------------------------------------------------------------
      &nbsp;         A non transmitted    B non transmitted   Total
------------------- -------------------- -------------------- --------
 A transmitted               a                   b             a+b

 B transmitted               c                   d             c+d
 
 Total                      a+c                 b+d             2n
----------------------------------------------------------------------

> - \[ \chi^2_{(TDT)} =  \frac{(b-c)^2}{b+c} \sim \chi^2_{(1)}   \]

> - This is also known as a McNemar Test

## Pedigree Disequilibrium Test (PDT) | Informative Trios

```{r, echo=FALSE, fig.align='center', message=FALSE}
library(kinship2)
test1 = data.frame(id =c(1, 2, 3),
                   mom =c(0, 0, 1),
                   dad =c(0, 0, 2),
                   sex =c(2, 1, 1),
                   affected=c(0,0,1))

aff2 <- data.frame(genotyped=c(1,1,1),
                    affected=test1$affected)
id2 <- paste(c("A/B", "A/A","A/A"),c("Linda", "James", "Theo"), sep="\n")
ped <- with(test1,pedigree(id,dad,mom,sex,affected = as.matrix(aff2)))
plot(ped,  id=id2)
pedigree.legend(ped, location="bottomleft", radius=.1)
```

## Pedigree Disequilibrium Test (PDT) | Informative Discordant Sibships

```{r, echo=FALSE, fig.align='center', message=FALSE}
test1 = data.frame(id =c(1, 2, 3, 4, 5),
                   mom =c(0, 0, 1, 1, 1),
                   dad =c(0, 0, 2, 2, 2),
                   sex =c(2, 1, 1, 2, 1),
                   affected=c(0,1,1,0,1),
                   famid=c(1,1,1,1,1))

aff2 <- data.frame(genotyped=c(0,0,1,1,0),
                   affected=test1$affected)


id2 <- paste(c("","","A/A","A/B",""),c("Linda", "James", "Theo", "Kim","Tom"),sep="\n")

ped <- with(test1,pedigree(id,dad,mom,sex,affected = as.matrix(aff2)), famid=famid)

#png("~/Dropbox/TRD_rmarkdown/informative.png")
plot(ped,  id=id2, branch=0.9)
pedigree.legend(ped, location="topright", radius=.08)
```




## Pedigree Disequilibrium Test (PDT)

Within an informative nuclear family define:

- $X_T$ = (#$A$ transmitted) - (#$A$ not transmitted)  $\rightarrow$ $n_T$ _trios_
- $X_S$ = (#$A$ affected sib) - (#$A$ unaffected sib) $\rightarrow$ $n_s$ _sibships_

\[D=\frac{1}{n_T + n_S} \left( \sum X_{T} + \sum X_{S} \right) \]

For $k=1,\ldots,N$ unrelated informative pedigrees

\[ PDT_{test} = \frac{\sum D_k}{\sqrt{\sum D_k^2 }} \sim \mathcal{N}(0,1) \]



## Family Based Association Test (FBAT) 

<div class="red2">A unified approach to family based tests of association that can handle:
</div>    

1. Different genetic models
2. Sampling designs 
3. Multiallelic markers
4. Quantitative traits
5. Missing parental genotype information

## Family Based Association Test (FBAT) 

> * The FBAT statistic is based on the **covariance** between genotype and phenotype

> * What is covariance ?

> * A measure of how much two random variables change together  
    + $R^2$ is normalized version of the covariance

## Family Based Association Test (FBAT) | Test Statistic

\[ U = \sum T^* \left[ X-E(X|P) \right] \rightarrow \textrm{Covariance} \]
\[ FBAT = \frac{U^2}{var(U)} \sim \chi^2_{(1)} \rightarrow \textrm{Test Statistic} \]

- $X$: translates offspring's genotype to a numeric value e.g. count of A alleles (random)
- $P$: genotype of offspring's parents (fixed)
- $T$: offspring's trait (fixed)
- summation is over all offspring in the sample


## Family Based Association Test (FBAT) | Why so flexible ?

> * Of interest is the offspring's genotype  
    + Missing parental genotypes are _nuisance_ parameters
> * Standard approach to handling _nuisance_ parameters:  
    + Find sufficient statistics for them 
    + Condition on the sufficient statistics 
    + Conditional distribution does not depend on _nuisance_ parameters

## Comparison of Methods {.smaller}

```{r  message = FALSE, echo=FALSE}
library(pander)
panderOptions("table.style" , "rmarkdown")
panderOptions("table.split.table" , Inf) # avoid to split the tables
attribute <- c("affected child", "1 heterozygous parent","biallelic markers","trios",
               "missing parental genotypes","discordant sibships","pedigrees","multiallelic markers", "quantitative Traits")
TDT <- c("&#10003;","&#10003;", "&#10003;","&#10003;","","","","","")
PDT <- c("&#10003;","&#10003;","&#10003;","&#10003;","&#10003;","&#10003;","&#10003;","","")
FBAT <- c("&#10003;","&#10003;","&#10003;","&#10003;","&#10003;","&#10003;","&#10003;","&#10003;","&#10003;")
```

```{r results='asis',echo=FALSE}
pandoc.table(data.frame(attribute,TDT,PDT,FBAT))
```

